{"version":3,"sources":["../src/core/parser/lexer.ts","../src/core/parser/diagram-parser.ts","../src/core/parser/animation-parser.ts","../src/core/parser/style-parser.ts","../src/core/parser/narration-parser.ts","../src/core/parser/config-parser.ts","../src/core/parser/dsl-parser.ts","../src/core/layout/flowchart-layout.ts","../src/core/animation/effects.ts","../src/core/animation/flow-effects.ts","../src/core/animation/camera.ts","../src/core/animation/timeline.ts","../src/components/renderer/NodeRenderer.tsx","../src/components/renderer/EdgeRenderer.tsx","../src/components/renderer/RoughNodeRenderer.tsx","../src/components/renderer/RoughEdgeRenderer.tsx","../src/components/renderer/DiagramRenderer.tsx","../src/components/renderer/NarrationOverlay.tsx","../src/store/diagram-store.ts","../src/components/controls/PlaybackControls.tsx","../src/components/AnimflowPlayer.tsx"],"names":["dagre","gsap","jsxs","jsx","useRef","useEffect","rough","renderText","useMemo","create","React","forwardRef","AnimflowPlayer","useState","narration","useCallback","useImperativeHandle"],"mappings":"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","file":"index.js","sourcesContent":["import type { DslSections } from \"../types\";\n\n/**\n * Split DSL text into sections: diagram, @animation, @style, @narration, @config\n */\nexport function splitDslSections(dsl: string): DslSections {\n  const sections: DslSections = {\n    diagram: \"\",\n  };\n\n  // Extract @animation section\n  const animMatch = dsl.match(/@animation\\s+([\\s\\S]*?)\\s*@end/);\n  if (animMatch) {\n    sections.animation = animMatch[1].trim();\n  }\n\n  // Extract @style section\n  const styleMatch = dsl.match(/@style\\s+([\\s\\S]*?)\\s*@end/);\n  if (styleMatch) {\n    sections.style = styleMatch[1].trim();\n  }\n\n  // Extract @narration section\n  const narrationMatch = dsl.match(/@narration\\s+([\\s\\S]*?)\\s*@end/);\n  if (narrationMatch) {\n    sections.narration = narrationMatch[1].trim();\n  }\n\n  // Extract @config section\n  const configMatch = dsl.match(/@config\\s+([\\s\\S]*?)\\s*@end/);\n  if (configMatch) {\n    sections.config = configMatch[1].trim();\n  }\n\n  // Remove all sections from diagram part\n  let diagramText = dsl;\n  diagramText = diagramText.replace(/@animation\\s+[\\s\\S]*?@end/g, \"\");\n  diagramText = diagramText.replace(/@style\\s+[\\s\\S]*?@end/g, \"\");\n  diagramText = diagramText.replace(/@narration\\s+[\\s\\S]*?@end/g, \"\");\n  diagramText = diagramText.replace(/@config\\s+[\\s\\S]*?@end/g, \"\");\n  sections.diagram = diagramText.trim();\n\n  return sections;\n}\n\n/**\n * Parse indented properties (duration, effect, etc.)\n */\nexport function parseIndentedProperties(text: string): Record<string, any> {\n  const props: Record<string, any> = {};\n  const lines = text.split(\"\\n\");\n\n  for (const line of lines) {\n    const trimmed = line.trim();\n    if (!trimmed || !trimmed.includes(\":\")) continue;\n\n    const colonIndex = trimmed.indexOf(\":\");\n    const key = trimmed.substring(0, colonIndex).trim();\n    const value = trimmed.substring(colonIndex + 1).trim();\n\n    // Parse boolean\n    if (value === \"true\") {\n      props[key] = true;\n    } else if (value === \"false\") {\n      props[key] = false;\n    }\n    // Parse number\n    else if (!isNaN(Number(value))) {\n      props[key] = Number(value);\n    }\n    // Parse string\n    else {\n      props[key] = value.replace(/^[\"']|[\"']$/g, \"\");\n    }\n  }\n\n  return props;\n}\n","import type {\n  DiagramNode,\n  DiagramEdge,\n  NodeShape,\n  FlowchartDirection,\n  EdgeStyle,\n} from \"../types\";\n\n/**\n * Parse flowchart diagram section\n */\nexport function parseFlowchart(diagramText: string): {\n  direction: FlowchartDirection;\n  nodes: DiagramNode[];\n  edges: DiagramEdge[];\n} {\n  const lines = diagramText.split(\"\\n\").map((l) => l.trim()).filter(Boolean);\n  \n  let direction: FlowchartDirection = \"LR\";\n  const nodes: DiagramNode[] = [];\n  const edges: DiagramEdge[] = [];\n  const nodeMap = new Map<string, DiagramNode>();\n\n  for (const line of lines) {\n    // Parse header: flowchart LR\n    if (line.startsWith(\"flowchart\")) {\n      const match = line.match(/flowchart\\s+(LR|RL|TD|BT)/);\n      if (match) {\n        direction = match[1] as FlowchartDirection;\n      }\n      continue;\n    }\n\n    // Parse edge: nodeA --> nodeB\n    if (line.includes(\"-->\") || line.includes(\"-.->\") || line.includes(\"==>\")) {\n      const edge = parseEdgeLine(line);\n      if (edge) {\n        edges.push(edge);\n      }\n      continue;\n    }\n\n    // Parse node: nodeId[label] or nodeId{label} etc.\n    const node = parseNodeLine(line);\n    if (node && !nodeMap.has(node.id)) {\n      nodes.push(node);\n      nodeMap.set(node.id, node);\n    }\n  }\n\n  return { direction, nodes, edges };\n}\n\n/**\n * Parse node definition line\n */\nfunction parseNodeLine(line: string): DiagramNode | null {\n  // Match patterns: nodeId[label], nodeId{label}, nodeId([label]), etc.\n  const patterns = [\n    { regex: /(\\w+)\\(\\[([^\\]]+)\\]\\)/, shape: \"terminator\" as NodeShape },\n    { regex: /(\\w+)\\[([^\\]]+)\\]/, shape: \"rectangle\" as NodeShape },\n    { regex: /(\\w+)\\{([^}]+)\\}/, shape: \"diamond\" as NodeShape },\n    { regex: /(\\w+)\\[\\/([^\\/]+)\\/\\]/, shape: \"parallelogram\" as NodeShape },\n    { regex: /(\\w+)\\[\\(([^\\)]+)\\)\\]/, shape: \"database\" as NodeShape },\n    { regex: /(\\w+)\\[\\[([^\\]]+)\\]\\]/, shape: \"document\" as NodeShape },\n  ];\n\n  for (const { regex, shape } of patterns) {\n    const match = line.match(regex);\n    if (match) {\n      const id = match[1];\n      const labelText = match[2];\n      \n      // Handle multi-line labels with <br/>\n      const parts = labelText.split(\"<br/>\").map(p => p.trim());\n      const label = parts[0];\n      const subtitle = parts.slice(1).join(\"\\n\");\n\n      return {\n        id,\n        shape,\n        label,\n        subtitle: subtitle || undefined,\n      };\n    }\n  }\n\n  return null;\n}\n\n/**\n * Parse edge definition line\n */\nfunction parseEdgeLine(line: string): DiagramEdge | null {\n  // Match: nodeA -->|label| nodeB or nodeA --> nodeB\n  let edgeStyle: EdgeStyle = \"solid\";\n  let arrowSymbol = \"-->\";\n\n  if (line.includes(\"-.->\")) {\n    edgeStyle = \"dashed\";\n    arrowSymbol = \".->\";\n  } else if (line.includes(\"==>\")) {\n    edgeStyle = \"thick\";\n    arrowSymbol = \"==>\";\n  }\n\n  // Extract label if present\n  const labelMatch = line.match(/\\|([^|]+)\\|/);\n  const label = labelMatch ? labelMatch[1].trim() : undefined;\n\n  // Remove label for node extraction\n  const cleanLine = line.replace(/\\|[^|]+\\|/g, \"\");\n\n  // Extract from and to nodes\n  const parts = cleanLine.split(arrowSymbol).map(p => p.trim());\n  if (parts.length !== 2) return null;\n\n  const from = parts[0];\n  const to = parts[1];\n\n  return {\n    id: `${from}_to_${to}`,\n    from,\n    to,\n    label,\n    style: edgeStyle,\n  };\n}\n","import type { AnimationStep, AnimationAction, AnimationProperties } from \"../types\";\nimport { parseIndentedProperties } from \"./lexer\";\n\n/**\n * Parse @animation section\n */\nexport function parseAnimation(animationText: string): AnimationStep[] {\n  const steps: AnimationStep[] = [];\n  const lines = animationText.split(\"\\n\");\n  \n  let currentStep: Partial<AnimationStep> | null = null;\n  let propertyLines: string[] = [];\n\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    const trimmed = line.trim();\n\n    // New step line: \"step 1: show nodeA\"\n    if (trimmed.startsWith(\"step \")) {\n      // Save previous step\n      if (currentStep) {\n        const props = parseIndentedProperties(propertyLines.join(\"\\n\"));\n        currentStep.properties = props as AnimationProperties;\n        steps.push(currentStep as AnimationStep);\n      }\n\n      // Parse new step\n      const match = trimmed.match(/step\\s+(\\d+):\\s+(\\w+)\\s+(.+)/);\n      if (match) {\n        const stepNum = parseInt(match[1], 10);\n        const action = match[2] as AnimationAction;\n        const targetsStr = match[3].trim();\n\n        // Parse targets (can be comma-separated or arrow-separated for connect)\n        let targets: string[] = [];\n        if (action === \"connect\") {\n          // Parse: nodeA->nodeB or nodeA->nodeB, nodeC->nodeD\n          const connections = targetsStr.split(\",\").map(s => s.trim());\n          targets = connections;\n        } else {\n          targets = targetsStr.split(\",\").map(s => s.trim());\n        }\n\n        currentStep = {\n          step: stepNum,\n          action,\n          targets,\n          properties: {},\n        };\n        propertyLines = [];\n      }\n    }\n    // Property line (indented)\n    else if (line.startsWith(\"  \") && currentStep) {\n      propertyLines.push(line);\n    }\n  }\n\n  // Save last step\n  if (currentStep) {\n    const props = parseIndentedProperties(propertyLines.join(\"\\n\"));\n    currentStep.properties = props as AnimationProperties;\n    steps.push(currentStep as AnimationStep);\n  }\n\n  return steps;\n}\n","import type { NodeStyle } from \"../types\";\n\n/**\n * Parse @style section\n */\nexport function parseStyle(styleText: string): Record<string, NodeStyle> {\n  const styles: Record<string, NodeStyle> = {};\n  const lines = styleText.split(\"\\n\");\n  \n  let currentNodeId: string | null = null;\n  let currentStyle: Partial<NodeStyle> = {};\n\n  for (const line of lines) {\n    const trimmed = line.trim();\n    if (!trimmed) continue;\n\n    // Node ID line: \"nodeId:\" or \".className:\"\n    if (trimmed.endsWith(\":\") && !line.startsWith(\"  \")) {\n      // Save previous style\n      if (currentNodeId) {\n        styles[currentNodeId] = currentStyle as NodeStyle;\n      }\n\n      currentNodeId = trimmed.slice(0, -1);\n      currentStyle = {};\n    }\n    // Property line\n    else if (line.startsWith(\"  \") && currentNodeId) {\n      const colonIndex = trimmed.indexOf(\":\");\n      if (colonIndex === -1) continue;\n\n      const key = trimmed.substring(0, colonIndex).trim();\n      const value = trimmed.substring(colonIndex + 1).trim();\n\n      // Convert kebab-case to camelCase\n      const camelKey = key.replace(/-([a-z])/g, (g) => g[1].toUpperCase());\n\n      // Parse value\n      if (camelKey === \"strokeWidth\" || camelKey === \"fontSize\") {\n        currentStyle[camelKey as keyof NodeStyle] = parseInt(value, 10) as any;\n      } else {\n        currentStyle[camelKey as keyof NodeStyle] = value as any;\n      }\n    }\n  }\n\n  // Save last style\n  if (currentNodeId) {\n    styles[currentNodeId] = currentStyle as NodeStyle;\n  }\n\n  return styles;\n}\n","import type { NarrationItem } from \"../types\";\n\n/**\n * Parse @narration section\n */\nexport function parseNarration(narrationText: string): NarrationItem[] {\n  const narrations: NarrationItem[] = [];\n  const lines = narrationText.split(\"\\n\");\n  \n  let currentNarration: Partial<NarrationItem> | null = null;\n  let currentKey: \"title\" | \"text\" | null = null;\n\n  for (const line of lines) {\n    const trimmed = line.trim();\n    if (!trimmed) continue;\n\n    // Step line: \"step 1:\"\n    if (trimmed.startsWith(\"step \") && trimmed.endsWith(\":\")) {\n      // Save previous narration\n      if (currentNarration && currentNarration.step !== undefined) {\n        narrations.push(currentNarration as NarrationItem);\n      }\n\n      const match = trimmed.match(/step\\s+(\\d+):/);\n      if (match) {\n        currentNarration = {\n          step: parseInt(match[1], 10),\n          title: \"\",\n          text: \"\",\n        };\n      }\n    }\n    // Property line: \"title: ...\", \"text: ...\"\n    else if (line.startsWith(\"  \") && currentNarration) {\n      const colonIndex = trimmed.indexOf(\":\");\n      if (colonIndex === -1) continue;\n\n      const key = trimmed.substring(0, colonIndex).trim();\n      const value = trimmed.substring(colonIndex + 1).trim();\n\n      if (key === \"title\" || key === \"text\") {\n        currentKey = key;\n        currentNarration[key] = value.replace(/^[\"']|[\"']$/g, \"\");\n      }\n    }\n  }\n\n  // Save last narration\n  if (currentNarration && currentNarration.step !== undefined) {\n    narrations.push(currentNarration as NarrationItem);\n  }\n\n  return narrations;\n}\n","import type { DiagramConfig } from \"../types\";\nimport { parseIndentedProperties } from \"./lexer\";\n\n/**\n * Parse @config section\n */\nexport function parseConfig(configText: string): DiagramConfig {\n  const props = parseIndentedProperties(configText);\n  \n  const config: DiagramConfig = {};\n\n  // Boolean properties\n  if (props.autoplay !== undefined) config.autoplay = props.autoplay;\n  if (props.loop !== undefined) config.loop = props.loop;\n  if (props.controls !== undefined) config.controls = props.controls;\n  if (props.timeline !== undefined) config.timeline = props.timeline;\n  if (props.narration !== undefined) config.narration = props.narration;\n\n  // Number properties\n  if (props.speed !== undefined) config.speed = props.speed;\n  if (props.width !== undefined) config.width = props.width;\n  if (props.height !== undefined) config.height = props.height;\n  if (props.fps !== undefined) config.fps = props.fps;\n\n  // String properties\n  if (props.background) config.background = props.background;\n  if (props.padding) config.padding = props.padding;\n  if (props.quality) config.quality = props.quality;\n\n  return config;\n}\n","import type { DiagramData, ParseResult } from \"../types\";\nimport { splitDslSections } from \"./lexer\";\nimport { parseFlowchart } from \"./diagram-parser\";\nimport { parseAnimation } from \"./animation-parser\";\nimport { parseStyle } from \"./style-parser\";\nimport { parseNarration } from \"./narration-parser\";\nimport { parseConfig } from \"./config-parser\";\n\n/**\n * Main DSL Parser\n * Parses complete DSL text and returns DiagramData\n */\nexport function parseDsl(dslText: string): ParseResult {\n  try {\n    // Split into sections\n    const sections = splitDslSections(dslText);\n\n    // Parse diagram (flowchart or mindmap)\n    const { direction, nodes, edges } = parseFlowchart(sections.diagram);\n\n    // Parse animations\n    const animations = sections.animation\n      ? parseAnimation(sections.animation)\n      : [];\n\n    // Parse styles\n    const styles = sections.style ? parseStyle(sections.style) : {};\n\n    // Parse narrations\n    const narrations = sections.narration\n      ? parseNarration(sections.narration)\n      : [];\n\n    // Parse config\n    const config = sections.config\n      ? parseConfig(sections.config)\n      : { autoplay: true, loop: false, controls: true };\n\n    // Assemble complete diagram data\n    const data: DiagramData = {\n      metadata: {\n        id: `diagram_${Date.now()}`,\n        type: \"flowchart\",\n        direction,\n        created: new Date().toISOString(),\n      },\n      nodes,\n      edges,\n      animations,\n      styles,\n      narrations,\n      config,\n    };\n\n    return {\n      success: true,\n      data,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      errors: [\n        {\n          line: 0,\n          column: 0,\n          message: error instanceof Error ? error.message : \"Unknown error\",\n          type: \"syntax\",\n        },\n      ],\n    };\n  }\n}\n","import dagre from \"dagre\";\nimport type { DiagramNode, DiagramEdge, FlowchartDirection } from \"../types\";\n\n/**\n * Calculate node positions using dagre layout algorithm\n */\nexport function calculateFlowchartLayout(\n  nodes: DiagramNode[],\n  edges: DiagramEdge[],\n  direction: FlowchartDirection = \"LR\"\n): { nodes: DiagramNode[]; edges: DiagramEdge[] } {\n  // Create a new directed graph\n  const g = new dagre.graphlib.Graph();\n\n  // Set graph options\n  g.setGraph({\n    rankdir: direction,\n    nodesep: 80,\n    edgesep: 40,\n    ranksep: 120,\n  });\n\n  // Default node settings\n  g.setDefaultEdgeLabel(() => ({}));\n\n  // Add nodes to graph\n  for (const node of nodes) {\n    const { width, height } = estimateNodeSize(node);\n    g.setNode(node.id, {\n      label: node.label,\n      width,\n      height,\n    });\n  }\n\n  // Add edges to graph\n  for (const edge of edges) {\n    g.setEdge(edge.from, edge.to);\n  }\n\n  // Run dagre layout algorithm\n  dagre.layout(g);\n\n  // Extract positioned nodes\n  const positionedNodes: DiagramNode[] = nodes.map((node) => {\n    const dagreNode = g.node(node.id);\n    return {\n      ...node,\n      position: {\n        x: dagreNode.x,\n        y: dagreNode.y,\n      },\n      width: dagreNode.width,\n      height: dagreNode.height,\n    };\n  });\n\n  // Calculate edge paths\n  const positionedEdges: DiagramEdge[] = edges.map((edge) => {\n    const dagreEdge = g.edge(edge.from, edge.to);\n    let points = dagreEdge?.points || [];\n    \n    // Filter out invalid points with NaN coordinates\n    points = points.filter((p: any) => \n      p && \n      typeof p.x === 'number' && \n      typeof p.y === 'number' && \n      !isNaN(p.x) && \n      !isNaN(p.y) &&\n      isFinite(p.x) && \n      isFinite(p.y)\n    );\n\n    // If no valid points, create simple fallback points\n    if (points.length < 2) {\n      const fromNode = g.node(edge.from);\n      const toNode = g.node(edge.to);\n      \n      if (fromNode && toNode) {\n        points = [\n          { x: fromNode.x, y: fromNode.y },\n          { x: toNode.x, y: toNode.y },\n        ];\n      }\n    }\n    \n    return {\n      ...edge,\n      points,\n    };\n  });\n\n  return {\n    nodes: positionedNodes,\n    edges: positionedEdges,\n  };\n}\n\n/**\n * Estimate node size based on label length\n */\nfunction estimateNodeSize(node: DiagramNode): { width: number; height: number } {\n  const lines = [node.label];\n  if (node.subtitle) {\n    lines.push(...node.subtitle.split(\"\\n\"));\n  }\n\n  const maxLineLength = Math.max(...lines.map((l) => l.length));\n  const lineCount = lines.length;\n\n  // Estimate width (roughly 8px per character + padding)\n  const width = Math.max(120, maxLineLength * 8 + 40);\n\n  // Estimate height (roughly 20px per line + padding)\n  const height = Math.max(60, lineCount * 24 + 30);\n\n  return { width, height };\n}\n\n/**\n * Calculate bezier curve path for edge\n */\nexport function calculateEdgePath(\n  points: { x: number; y: number }[]\n): string {\n  if (points.length < 2) return \"\";\n\n  // Filter out invalid points (NaN or undefined)\n  const validPoints = points.filter(p => \n    p && \n    typeof p.x === 'number' && \n    typeof p.y === 'number' && \n    !isNaN(p.x) && \n    !isNaN(p.y)\n  );\n\n  if (validPoints.length < 2) return \"\";\n\n  // If only 2 points or nearly straight line, use direct line\n  if (validPoints.length === 2) {\n    return `M ${validPoints[0].x} ${validPoints[0].y} L ${validPoints[1].x} ${validPoints[1].y}`;\n  }\n\n  // Check if all points are on a straight line (horizontal or vertical)\n  const isHorizontal = validPoints.every(p => Math.abs(p.y - validPoints[0].y) < 1);\n  const isVertical = validPoints.every(p => Math.abs(p.x - validPoints[0].x) < 1);\n  \n  if (isHorizontal || isVertical) {\n    // Draw straight line from start to end\n    return `M ${validPoints[0].x} ${validPoints[0].y} L ${validPoints[validPoints.length - 1].x} ${validPoints[validPoints.length - 1].y}`;\n  }\n\n  // For bent lines, use first, middle bend point, and last\n  let path = `M ${validPoints[0].x} ${validPoints[0].y}`;\n  \n  // Just use key points to avoid too many bends\n  if (validPoints.length > 2) {\n    const midIndex = Math.floor(validPoints.length / 2);\n    path += ` L ${validPoints[midIndex].x} ${validPoints[midIndex].y}`;\n  }\n  \n  path += ` L ${validPoints[validPoints.length - 1].x} ${validPoints[validPoints.length - 1].y}`;\n\n  return path;\n}\n","import gsap from \"gsap\";\nimport type { EntranceEffect, ExitEffect, EmphasisEffect } from \"../types\";\n\n/**\n * Apply entrance effect to element\n */\nexport function applyEntranceEffect(\n  element: Element,\n  effect: EntranceEffect,\n  duration: number = 1\n): gsap.core.Tween {\n  // Start with element visible\n  gsap.set(element, { opacity: 1 });\n\n  switch (effect) {\n    case \"fadeIn\":\n      return gsap.from(element, {\n        opacity: 0,\n        duration,\n        ease: \"power2.out\",\n      });\n\n    case \"slideInRight\":\n      return gsap.from(element, {\n        x: 100,\n        opacity: 0,\n        duration,\n        ease: \"power2.out\",\n      });\n\n    case \"slideInLeft\":\n      return gsap.from(element, {\n        x: -100,\n        opacity: 0,\n        duration,\n        ease: \"power2.out\",\n      });\n\n    case \"slideInTop\":\n      return gsap.from(element, {\n        y: -100,\n        opacity: 0,\n        duration,\n        ease: \"power2.out\",\n      });\n\n    case \"slideInBottom\":\n      return gsap.from(element, {\n        y: 100,\n        opacity: 0,\n        duration,\n        ease: \"power2.out\",\n      });\n\n    case \"scaleIn\":\n      return gsap.from(element, {\n        scale: 0,\n        opacity: 0,\n        duration,\n        ease: \"back.out(1.7)\",\n      });\n\n    case \"bounceIn\":\n      return gsap.from(element, {\n        scale: 0,\n        opacity: 0,\n        duration,\n        ease: \"bounce.out\",\n      });\n\n    case \"flipIn\":\n      return gsap.from(element, {\n        rotationY: -90,\n        opacity: 0,\n        duration,\n        ease: \"power2.out\",\n      });\n\n    case \"rotateIn\":\n      return gsap.from(element, {\n        rotation: -180,\n        opacity: 0,\n        duration,\n        ease: \"power2.out\",\n      });\n\n    default:\n      return gsap.from(element, {\n        opacity: 0,\n        duration,\n      });\n  }\n}\n\n/**\n * Apply exit effect to element\n */\nexport function applyExitEffect(\n  element: Element,\n  effect: ExitEffect,\n  duration: number = 1\n): gsap.core.Tween {\n  switch (effect) {\n    case \"fadeOut\":\n      return gsap.to(element, {\n        opacity: 0,\n        duration,\n        ease: \"power2.in\",\n      });\n\n    case \"slideOutLeft\":\n      return gsap.to(element, {\n        x: -100,\n        opacity: 0,\n        duration,\n        ease: \"power2.in\",\n      });\n\n    case \"slideOutRight\":\n      return gsap.to(element, {\n        x: 100,\n        opacity: 0,\n        duration,\n        ease: \"power2.in\",\n      });\n\n    case \"scaleOut\":\n      return gsap.to(element, {\n        scale: 0,\n        opacity: 0,\n        duration,\n        ease: \"back.in(1.7)\",\n      });\n\n    case \"bounceOut\":\n      return gsap.to(element, {\n        scale: 0,\n        opacity: 0,\n        duration,\n        ease: \"bounce.in\",\n      });\n\n    default:\n      return gsap.to(element, {\n        opacity: 0,\n        duration,\n      });\n  }\n}\n\n/**\n * Apply emphasis effect to element\n */\nexport function applyEmphasisEffect(\n  element: Element,\n  effect: EmphasisEffect,\n  duration: number = 1\n): gsap.core.Tween {\n  switch (effect) {\n    case \"pulse\":\n      return gsap.to(element, {\n        scale: 1.1,\n        duration: duration / 2,\n        yoyo: true,\n        repeat: 1,\n        ease: \"power2.inOut\",\n      });\n\n    case \"shake\":\n      return gsap.to(element, {\n        x: -10,\n        duration: 0.1,\n        yoyo: true,\n        repeat: 5,\n        ease: \"power1.inOut\",\n      });\n\n    case \"bounce\":\n      return gsap.to(element, {\n        y: -20,\n        duration: duration / 2,\n        yoyo: true,\n        repeat: 1,\n        ease: \"bounce.out\",\n      });\n\n    case \"flash\":\n      return gsap.to(element, {\n        opacity: 0.3,\n        duration: duration / 4,\n        yoyo: true,\n        repeat: 3,\n        ease: \"power1.inOut\",\n      });\n\n    default:\n      return gsap.to(element, {\n        scale: 1,\n        duration,\n      });\n  }\n}\n\n/**\n * Apply glow effect using SVG filter\n */\nexport function applyGlowEffect(\n  element: Element,\n  color: string,\n  duration: number = 1\n): gsap.core.Tween {\n  return gsap.to(element, {\n    filter: `drop-shadow(0 0 10px ${color})`,\n    duration,\n    ease: \"power2.out\",\n  });\n}\n\n/**\n * Remove glow effect\n */\nexport function removeGlowEffect(\n  element: Element,\n  duration: number = 0.5\n): gsap.core.Tween {\n  return gsap.to(element, {\n    filter: \"none\",\n    duration,\n    ease: \"power2.in\",\n  });\n}\n","import gsap from \"gsap\";\nimport type { FlowEffect } from \"../types\";\n\n/**\n * Animate edge connection with flow effect\n */\nexport function animateEdgeFlow(\n  edgeElement: Element,\n  effect: FlowEffect,\n  duration: number = 2\n): gsap.core.Tween | gsap.core.Timeline {\n  const pathElement = edgeElement.querySelector(\".edge-path\") as SVGPathElement;\n  \n  if (!pathElement) {\n    return gsap.to(edgeElement, { opacity: 1, duration: 0 });\n  }\n\n  // Make edge visible\n  gsap.set(edgeElement, { opacity: 1 });\n\n  switch (effect) {\n    case \"particles\":\n      return animateParticles(edgeElement, pathElement, duration);\n\n    case \"dash\":\n      return animateDash(edgeElement, pathElement, duration);\n\n    case \"arrow\":\n      return animateArrow(edgeElement, pathElement, duration);\n\n    default:\n      return animateParticles(edgeElement, pathElement, duration);\n  }\n}\n\n/**\n * Animate path drawing + arrow reveal\n */\nfunction animateParticles(\n  edgeElement: Element,\n  pathElement: SVGPathElement,\n  duration: number\n): gsap.core.Timeline {\n  const totalLength = pathElement.getTotalLength();\n  \n  // For sketchy mode, animate rough overlays\n  const roughPathContainer = edgeElement.querySelector('.rough-path-container');\n  const roughArrowEl = edgeElement.querySelector('.rough-arrow-overlay');\n\n  const tl = gsap.timeline();\n\n  if (roughPathContainer) {\n    // Sketchy mode: fade in from 0 to 1\n    tl.fromTo(roughPathContainer, \n      { opacity: 0 },\n      {\n        opacity: 1,\n        duration,\n        ease: \"power1.inOut\",\n      }\n    );\n\n    if (roughArrowEl) {\n      tl.fromTo(roughArrowEl,\n        { opacity: 0 },\n        { opacity: 1, duration: 0.3 },\n        `-=0.3`\n      );\n    }\n  } else {\n    // Clean mode: stroke dash animation\n    const arrowEl = edgeElement.querySelector('.edge-arrow');\n\n    gsap.set(pathElement, {\n      strokeDasharray: totalLength,\n      strokeDashoffset: totalLength,\n    });\n\n    tl.to(pathElement, {\n      strokeDashoffset: 0,\n      duration,\n      ease: \"power1.inOut\",\n    });\n\n    if (arrowEl) {\n      tl.fromTo(arrowEl,\n        { opacity: 0 },\n        { opacity: 1, duration: 0.3 },\n        `-=0.3`\n      );\n    }\n  }\n\n  return tl;\n}\n\n/**\n * Animate dashed line moving\n */\nfunction animateDash(\n  edgeElement: Element,\n  pathElement: SVGPathElement,\n  duration: number\n): gsap.core.Timeline {\n  const roughPathContainer = edgeElement.querySelector('.rough-path-container');\n  const roughArrowEl = edgeElement.querySelector('.rough-arrow-overlay');\n\n  const tl = gsap.timeline();\n\n  if (roughPathContainer) {\n    // Sketchy mode: fade in\n    tl.fromTo(roughPathContainer,\n      { opacity: 0 },\n      {\n        opacity: 1,\n        duration,\n        ease: \"linear\",\n      }\n    );\n\n    if (roughArrowEl) {\n      tl.fromTo(roughArrowEl,\n        { opacity: 0 },\n        { opacity: 1, duration: 0.3 },\n        `-=0.3`\n      );\n    }\n  } else {\n    // Clean mode: dash animation\n    const arrowEl = edgeElement.querySelector('.edge-arrow');\n\n    gsap.set(pathElement, {\n      strokeDasharray: \"10, 5\",\n    });\n\n    tl.fromTo(\n      pathElement,\n      { strokeDashoffset: 0 },\n      {\n        strokeDashoffset: 15,\n        duration: 1,\n        repeat: Math.ceil(duration) - 1,\n        ease: \"linear\",\n      }\n    );\n\n    if (arrowEl) {\n      tl.fromTo(arrowEl,\n        { opacity: 0 },\n        { opacity: 1, duration: 0.3 },\n        `-=0.3`\n      );\n    }\n  }\n\n  return tl;\n}\n\n/**\n * Animate arrow moving along path\n */\nfunction animateArrow(\n  edgeElement: Element,\n  pathElement: SVGPathElement,\n  duration: number\n): gsap.core.Timeline {\n  const totalLength = pathElement.getTotalLength();\n  const roughPathContainer = edgeElement.querySelector('.rough-path-container');\n  const roughArrowEl = edgeElement.querySelector('.rough-arrow-overlay');\n\n  const tl = gsap.timeline();\n\n  if (roughPathContainer) {\n    // Sketchy mode: fade in\n    tl.fromTo(roughPathContainer,\n      { opacity: 0 },\n      {\n        opacity: 1,\n        duration,\n        ease: \"power2.inOut\",\n      }\n    );\n\n    if (roughArrowEl) {\n      tl.fromTo(roughArrowEl,\n        { opacity: 0 },\n        { opacity: 1, duration: 0.3 },\n        `-=0.3`\n      );\n    }\n  } else {\n    // Clean mode: stroke dash animation\n    const arrowEl = edgeElement.querySelector('.edge-arrow');\n\n    gsap.set(pathElement, {\n      strokeDasharray: `${totalLength} ${totalLength}`,\n      strokeDashoffset: totalLength,\n    });\n\n    tl.to(pathElement, {\n      strokeDashoffset: 0,\n      duration,\n      ease: \"power2.inOut\",\n    });\n\n    if (arrowEl) {\n      tl.fromTo(arrowEl,\n        { opacity: 0 },\n        { opacity: 1, duration: 0.3 },\n        `-=0.3`\n      );\n    }\n  }\n\n  return tl;\n}\n","import gsap from \"gsap\";\nimport type { CameraAction } from \"../types\";\n\n/**\n * Animate SVG viewBox for camera effects\n */\nexport function animateCamera(\n  svgElement: SVGSVGElement,\n  action: CameraAction,\n  options: {\n    target?: string;\n    targets?: string[];\n    zoom?: number;\n    padding?: number;\n    duration?: number;\n  } = {}\n): gsap.core.Tween {\n  const duration = options.duration || 1;\n\n  switch (action) {\n    case \"fitAll\":\n      return fitAllNodes(svgElement, options.padding || 50, duration);\n\n    case \"focus\":\n      if (options.target) {\n        return focusNode(svgElement, options.target, options.zoom || 2, duration);\n      }\n      break;\n\n    case \"fitNodes\":\n      if (options.targets && options.targets.length > 0) {\n        return fitNodes(svgElement, options.targets, options.padding || 50, duration);\n      }\n      break;\n  }\n\n  return gsap.to(svgElement, { duration: 0 });\n}\n\n/**\n * Fit all nodes in view\n */\nfunction fitAllNodes(\n  svgElement: SVGSVGElement,\n  padding: number,\n  duration: number\n): gsap.core.Tween {\n  const nodesLayer = svgElement.querySelector(\".nodes-layer\");\n  if (!nodesLayer) return gsap.to(svgElement, { duration: 0 });\n\n  const bbox = (nodesLayer as SVGGElement).getBBox();\n  \n  const viewBox = {\n    x: bbox.x - padding,\n    y: bbox.y - padding,\n    width: bbox.width + padding * 2,\n    height: bbox.height + padding * 2,\n  };\n\n  return gsap.to(svgElement, {\n    attr: {\n      viewBox: `${viewBox.x} ${viewBox.y} ${viewBox.width} ${viewBox.height}`,\n    },\n    duration,\n    ease: \"power2.inOut\",\n  });\n}\n\n/**\n * Focus on specific node\n */\nfunction focusNode(\n  svgElement: SVGSVGElement,\n  nodeId: string,\n  zoom: number,\n  duration: number\n): gsap.core.Tween {\n  const nodeGroup = svgElement.querySelector(`[data-node-id=\"${nodeId}\"]`);\n  if (!nodeGroup) return gsap.to(svgElement, { duration: 0 });\n\n  const bbox = (nodeGroup as SVGGElement).getBBox();\n  \n  const viewBox = {\n    x: bbox.x - bbox.width / zoom,\n    y: bbox.y - bbox.height / zoom,\n    width: bbox.width * (1 + 1 / zoom),\n    height: bbox.height * (1 + 1 / zoom),\n  };\n\n  return gsap.to(svgElement, {\n    attr: {\n      viewBox: `${viewBox.x} ${viewBox.y} ${viewBox.width} ${viewBox.height}`,\n    },\n    duration,\n    ease: \"power2.inOut\",\n  });\n}\n\n/**\n * Fit specific nodes in view\n */\nfunction fitNodes(\n  svgElement: SVGSVGElement,\n  nodeIds: string[],\n  padding: number,\n  duration: number\n): gsap.core.Tween {\n  const nodes = nodeIds.map((id) =>\n    svgElement.querySelector(`[data-node-id=\"${id}\"]`)\n  ).filter(Boolean);\n\n  if (nodes.length === 0) return gsap.to(svgElement, { duration: 0 });\n\n  // Calculate combined bounding box\n  let minX = Infinity;\n  let minY = Infinity;\n  let maxX = -Infinity;\n  let maxY = -Infinity;\n\n  for (const node of nodes) {\n    const bbox = (node as SVGGElement).getBBox();\n    minX = Math.min(minX, bbox.x);\n    minY = Math.min(minY, bbox.y);\n    maxX = Math.max(maxX, bbox.x + bbox.width);\n    maxY = Math.max(maxY, bbox.y + bbox.height);\n  }\n\n  const viewBox = {\n    x: minX - padding,\n    y: minY - padding,\n    width: maxX - minX + padding * 2,\n    height: maxY - minY + padding * 2,\n  };\n\n  return gsap.to(svgElement, {\n    attr: {\n      viewBox: `${viewBox.x} ${viewBox.y} ${viewBox.width} ${viewBox.height}`,\n    },\n    duration,\n    ease: \"power2.inOut\",\n  });\n}\n","import gsap from \"gsap\";\nimport type { DiagramData, AnimationStep } from \"../types\";\nimport {\n  applyEntranceEffect,\n  applyExitEffect,\n  applyGlowEffect,\n  removeGlowEffect,\n} from \"./effects\";\nimport { animateEdgeFlow } from \"./flow-effects\";\nimport { animateCamera } from \"./camera\";\n\ninterface AnimationTimelineOptions {\n  onStepChange?: (step: number) => void;\n}\n\n/**\n * Animation Timeline Manager\n */\nexport class AnimationTimeline {\n  private timeline: gsap.core.Timeline;\n  private svgElement: SVGSVGElement | null = null;\n  private data: DiagramData;\n  private onStepChange?: (step: number) => void;\n  private stepBoundaries: { step: number; start: number; end: number }[] = [];\n\n  constructor(data: DiagramData, options?: AnimationTimelineOptions) {\n    this.data = data;\n    this.onStepChange = options?.onStepChange;\n    this.timeline = gsap.timeline({\n      paused: true,\n      onUpdate: () => this.onTimelineUpdate(),\n    });\n  }\n\n  /**\n   * Build timeline from animation steps\n   */\n  buildTimeline(svgElement: SVGSVGElement): void {\n    this.svgElement = svgElement;\n    this.timeline.clear();\n    this.stepBoundaries = [];\n\n    // Show all nodes immediately (no animation)\n    this.showAllNodesImmediately();\n\n    // Group steps by step number\n    const stepGroups = this.groupStepsByNumber(this.data.animations);\n\n    // Add each step group to timeline sequentially and collect boundaries.\n    for (const [stepNum, steps] of stepGroups) {\n      const stepStart = this.timeline.duration();\n      // Notify active step when playback reaches this step boundary.\n      this.timeline.call(() => {\n        this.onStepChange?.(stepNum);\n      });\n      for (const step of steps) {\n        this.addStepToTimeline(step);\n      }\n      const stepEnd = this.timeline.duration();\n      this.stepBoundaries.push({ step: stepNum, start: stepStart, end: stepEnd });\n    }\n  }\n\n  /**\n   * Show all nodes immediately without animation\n   */\n  private showAllNodesImmediately(): void {\n    if (!this.svgElement) return;\n\n    const allNodes = this.svgElement.querySelectorAll('[data-node-id]');\n    allNodes.forEach((node) => {\n      gsap.set(node, { opacity: 1 });\n    });\n  }\n\n  /**\n   * Group animation steps by step number\n   */\n  private groupStepsByNumber(\n    steps: AnimationStep[]\n  ): Map<number, AnimationStep[]> {\n    const groups = new Map<number, AnimationStep[]>();\n\n    for (const step of steps) {\n      if (!groups.has(step.step)) {\n        groups.set(step.step, []);\n      }\n      groups.get(step.step)!.push(step);\n    }\n\n    return groups;\n  }\n\n  /**\n   * Add animation step to timeline\n   */\n  private addStepToTimeline(step: AnimationStep): void {\n    if (!this.svgElement) return;\n\n    const { action, targets, properties } = step;\n    const duration = this.parseDuration(properties.duration || \"1s\");\n    const delay = this.parseDuration(properties.delay || \"0s\");\n\n    switch (action) {\n      case \"show\":\n        this.addShowAnimation(targets, properties, duration, delay);\n        break;\n\n      case \"hide\":\n        this.addHideAnimation(targets, properties, duration, delay);\n        break;\n\n      case \"highlight\":\n        this.addHighlightAnimation(targets, properties, duration, delay);\n        break;\n\n      case \"unhighlight\":\n        this.addUnhighlightAnimation(targets, duration, delay);\n        break;\n\n      case \"connect\":\n        this.addConnectAnimation(targets, properties, duration, delay);\n        break;\n\n      case \"camera\":\n        this.addCameraAnimation(properties, duration, delay);\n        break;\n\n      case \"annotate\":\n        this.addAnnotateAnimation(targets, properties, duration, delay);\n        break;\n    }\n  }\n\n  /**\n   * Add show animation\n   * Now nodes are already visible, so show action is skipped for nodes\n   */\n  private addShowAnimation(\n    targets: string[],\n    properties: any,\n    duration: number,\n    delay: number\n  ): void {\n    // Nodes are already visible, skip show animation\n    // This keeps the step timing intact but doesn't animate nodes\n  }\n\n  /**\n   * Add hide animation\n   */\n  private addHideAnimation(\n    targets: string[],\n    properties: any,\n    duration: number,\n    delay: number\n  ): void {\n    if (!this.svgElement) return;\n\n    const effect = properties.effect || \"fadeOut\";\n\n    targets.forEach((targetId) => {\n      const element = this.svgElement!.querySelector(`[data-node-id=\"${targetId}\"]`);\n      if (!element) return;\n\n      const tween = applyExitEffect(element, effect, duration);\n      this.timeline.add(tween, delay);\n    });\n  }\n\n  /**\n   * Add highlight animation\n   */\n  private addHighlightAnimation(\n    targets: string[],\n    properties: any,\n    duration: number,\n    delay: number\n  ): void {\n    if (!this.svgElement) return;\n\n    const color = properties.color || \"#FFD700\";\n    const glow = properties.glow || false;\n    const pulse = properties.pulse || false;\n    const stagger = this.parseDuration(properties.stagger || \"0s\");\n\n    targets.forEach((targetId, index) => {\n      const element = this.svgElement!.querySelector(`[data-node-id=\"${targetId}\"]`);\n      if (!element) return;\n\n      // Change fill color\n      const rect = element.querySelector(\"rect, ellipse, polygon, path\");\n      if (rect) {\n        this.timeline.to(\n          rect,\n          {\n            fill: color,\n            duration: duration / 2,\n            ease: \"power2.out\",\n          },\n          stagger > 0 ? `+=${index * stagger}` : \"+=0\"\n        );\n      }\n\n      // Add glow effect\n      if (glow) {\n        const glowTween = applyGlowEffect(element, color, duration / 2);\n        this.timeline.add(glowTween, stagger > 0 ? `+=${index * stagger}` : \"+=0\");\n      }\n\n      // Add pulse effect\n      if (pulse) {\n        this.timeline.to(\n          element,\n          {\n            scale: 1.1,\n            duration: duration / 4,\n            yoyo: true,\n            repeat: 1,\n            ease: \"power2.inOut\",\n          },\n          stagger > 0 ? `+=${index * stagger}` : \"+=0\"\n        );\n      }\n    });\n  }\n\n  /**\n   * Add unhighlight animation\n   */\n  private addUnhighlightAnimation(\n    targets: string[],\n    duration: number,\n    delay: number\n  ): void {\n    if (!this.svgElement) return;\n\n    targets.forEach((targetId) => {\n      const element = this.svgElement!.querySelector(`[data-node-id=\"${targetId}\"]`);\n      if (!element) return;\n\n      // Remove glow\n      const removeGlow = removeGlowEffect(element, duration / 2);\n      this.timeline.add(removeGlow, delay);\n\n      // Reset scale\n      this.timeline.to(\n        element,\n        {\n          scale: 1,\n          duration: duration / 2,\n        },\n        delay\n      );\n    });\n  }\n\n  /**\n   * Add connect animation\n   */\n  private addConnectAnimation(\n    targets: string[],\n    properties: any,\n    duration: number,\n    delay: number\n  ): void {\n    if (!this.svgElement) return;\n\n    const flow = properties.flow || \"particles\";\n    const speed = this.parseDuration(properties.speed || \"2s\");\n\n    // targets format: [\"nodeA->nodeB\", \"nodeC->nodeD\"]\n    targets.forEach((connection) => {\n      const [from, to] = connection.split(\"->\").map((s) => s.trim());\n      const edgeElement = this.svgElement!.querySelector(\n        `[data-from=\"${from}\"][data-to=\"${to}\"]`\n      );\n\n      if (!edgeElement) return;\n\n      const tween = animateEdgeFlow(edgeElement, flow, speed);\n      // Add to end of timeline for sequential execution\n      this.timeline.add(tween, \"+=0\");\n    });\n  }\n\n  /**\n   * Add camera animation\n   */\n  private addCameraAnimation(\n    properties: any,\n    duration: number,\n    delay: number\n  ): void {\n    if (!this.svgElement) return;\n\n    const action = properties.cameraAction || \"fitAll\";\n    const tween = animateCamera(this.svgElement, action, {\n      target: properties.target,\n      targets: properties.targets,\n      zoom: properties.zoom,\n      padding: this.parsePadding(properties.padding),\n      duration,\n    });\n\n    // Add to end of timeline for sequential execution\n    this.timeline.add(tween, \"+=0\");\n  }\n\n  /**\n   * Add annotate animation (placeholder)\n   */\n  private addAnnotateAnimation(\n    targets: string[],\n    properties: any,\n    duration: number,\n    delay: number\n  ): void {\n    // TODO: Implement annotation overlay\n  }\n\n  /**\n   * Parse duration string (e.g., \"1.5s\" -> 1.5)\n   */\n  private parseDuration(durationStr: string): number {\n    const match = durationStr.match(/([0-9.]+)s?/);\n    return match ? parseFloat(match[1]) : 1;\n  }\n\n  /**\n   * Parse padding string (e.g., \"50px\" -> 50)\n   */\n  private parsePadding(paddingStr?: string): number {\n    if (!paddingStr) return 50;\n    const match = paddingStr.match(/([0-9]+)/);\n    return match ? parseInt(match[1], 10) : 50;\n  }\n\n  /**\n   * Timeline update callback\n   */\n  private onTimelineUpdate(): void {\n    // Can be used for progress tracking\n  }\n\n  /**\n   * Playback controls\n   */\n  play(): void {\n    this.timeline.play();\n  }\n\n  pause(): void {\n    this.timeline.pause();\n  }\n\n  restart(): void {\n    this.timeline.restart();\n  }\n\n  stop(): void {\n    this.timeline.pause();\n    this.timeline.seek(0);\n  }\n\n  seek(time: number): void {\n    this.timeline.seek(time);\n  }\n\n  setSpeed(speed: number): void {\n    this.timeline.timeScale(speed);\n  }\n\n  getCurrentTime(): number {\n    return this.timeline.time();\n  }\n\n  getDuration(): number {\n    return this.timeline.duration();\n  }\n\n  getStepBoundaries(): { step: number; start: number; end: number }[] {\n    return [...this.stepBoundaries];\n  }\n\n  isPlaying(): boolean {\n    return this.timeline.isActive();\n  }\n}\n","\"use client\";\n\nimport React from \"react\";\nimport type { DiagramNode, NodeShape } from \"../../core/types\";\n\ninterface NodeRendererProps {\n  node: DiagramNode;\n  style?: React.CSSProperties;\n}\n\nexport function NodeRenderer({ node, style }: NodeRendererProps) {\n  const { id, shape, label, subtitle, position, width, height } = node;\n\n  if (!position || !width || !height) return null;\n\n  const x = position.x - width / 2;\n  const y = position.y - height / 2;\n\n  // Default styles\n  const fill = node.style?.fill || \"#e3f2fd\";\n  const stroke = node.style?.stroke || \"#2196F3\";\n  const strokeWidth = node.style?.strokeWidth || 2;\n  const textColor = node.style?.color || \"#000000\";\n\n  return (\n    <g\n      id={`node-${id}`}\n      data-node-id={id}\n      style={{ opacity: 1, ...style }} // Nodes always visible\n      className=\"node-group\"\n    >\n      {renderShape(shape, x, y, width, height, fill, stroke, strokeWidth)}\n      {renderText(label, subtitle, position.x, position.y, textColor)}\n    </g>\n  );\n}\n\n/**\n * Render node shape based on type\n */\nfunction renderShape(\n  shape: NodeShape,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  fill: string,\n  stroke: string,\n  strokeWidth: number\n) {\n  const commonProps = {\n    fill,\n    stroke,\n    strokeWidth,\n  };\n\n  switch (shape) {\n    case \"rectangle\":\n      return (\n        <rect\n          x={x}\n          y={y}\n          width={width}\n          height={height}\n          rx={4}\n          {...commonProps}\n        />\n      );\n\n    case \"terminator\":\n      return (\n        <ellipse\n          cx={x + width / 2}\n          cy={y + height / 2}\n          rx={width / 2}\n          ry={height / 2}\n          {...commonProps}\n        />\n      );\n\n    case \"diamond\":\n      const cx = x + width / 2;\n      const cy = y + height / 2;\n      const points = `\n        ${cx},${y}\n        ${x + width},${cy}\n        ${cx},${y + height}\n        ${x},${cy}\n      `;\n      return <polygon points={points} {...commonProps} />;\n\n    case \"parallelogram\":\n      const offset = width * 0.15;\n      const paraPoints = `\n        ${x + offset},${y}\n        ${x + width},${y}\n        ${x + width - offset},${y + height}\n        ${x},${y + height}\n      `;\n      return <polygon points={paraPoints} {...commonProps} />;\n\n    case \"database\":\n      const dbHeight = height * 0.15;\n      return (\n        <g>\n          <ellipse\n            cx={x + width / 2}\n            cy={y + dbHeight}\n            rx={width / 2}\n            ry={dbHeight}\n            {...commonProps}\n          />\n          <rect\n            x={x}\n            y={y + dbHeight}\n            width={width}\n            height={height - dbHeight * 2}\n            fill={fill}\n            stroke=\"none\"\n          />\n          <line\n            x1={x}\n            y1={y + dbHeight}\n            x2={x}\n            y2={y + height - dbHeight}\n            stroke={stroke}\n            strokeWidth={strokeWidth}\n          />\n          <line\n            x1={x + width}\n            y1={y + dbHeight}\n            x2={x + width}\n            y2={y + height - dbHeight}\n            stroke={stroke}\n            strokeWidth={strokeWidth}\n          />\n          <ellipse\n            cx={x + width / 2}\n            cy={y + height - dbHeight}\n            rx={width / 2}\n            ry={dbHeight}\n            {...commonProps}\n          />\n        </g>\n      );\n\n    case \"document\":\n      const wavePath = `\n        M ${x} ${y}\n        L ${x + width} ${y}\n        L ${x + width} ${y + height - 10}\n        Q ${x + width * 0.75} ${y + height - 15}, ${x + width / 2} ${y + height - 10}\n        Q ${x + width * 0.25} ${y + height - 5}, ${x} ${y + height - 10}\n        Z\n      `;\n      return <path d={wavePath} {...commonProps} />;\n\n    default:\n      return (\n        <rect\n          x={x}\n          y={y}\n          width={width}\n          height={height}\n          rx={4}\n          {...commonProps}\n        />\n      );\n  }\n}\n\n/**\n * Render text label\n */\nfunction renderText(\n  label: string,\n  subtitle: string | undefined,\n  cx: number,\n  cy: number,\n  color: string\n) {\n  const lines = [label];\n  if (subtitle) {\n    lines.push(...subtitle.split(\"\\n\"));\n  }\n\n  const lineHeight = 20;\n  const startY = cy - ((lines.length - 1) * lineHeight) / 2;\n\n  return (\n    <text\n      x={cx}\n      y={startY}\n      textAnchor=\"middle\"\n      dominantBaseline=\"middle\"\n      fill={color}\n      fontSize=\"14\"\n      fontFamily=\"system-ui, sans-serif\"\n    >\n      {lines.map((line, i) => (\n        <tspan key={i} x={cx} dy={i === 0 ? 0 : lineHeight}>\n          {line}\n        </tspan>\n      ))}\n    </text>\n  );\n}\n","\"use client\";\n\nimport React from \"react\";\nimport type { DiagramEdge } from \"../../core/types\";\nimport { calculateEdgePath } from \"../../core/layout/flowchart-layout\";\n\ninterface EdgeRendererProps {\n  edge: DiagramEdge;\n  style?: React.CSSProperties;\n}\n\nexport function EdgeRenderer({ edge, style }: EdgeRendererProps) {\n  const { id, from, to, label, points, style: edgeStyle } = edge;\n\n  if (!points || points.length < 2) return null;\n\n  const path = calculateEdgePath(points);\n  const stroke = \"#757575\";\n  const strokeWidth = edgeStyle === \"thick\" ? 3 : 2;\n  const strokeDasharray = edgeStyle === \"dashed\" ? \"5,5\" : undefined;\n\n  // Calculate label position (middle of path)\n  const midPoint = points[Math.floor(points.length / 2)];\n\n  return (\n    <g\n      id={`edge-${id}`}\n      data-edge-id={id}\n      data-from={from}\n      data-to={to}\n      style={{ opacity: 0, ...style }} // Edges hidden initially\n      className=\"edge-group\"\n    >\n      {/* Main path */}\n      <path\n        className=\"edge-path\"\n        d={path}\n        fill=\"none\"\n        stroke={stroke}\n        strokeWidth={strokeWidth}\n        strokeDasharray={strokeDasharray}\n      />\n\n      {/* Arrow marker - will be added during animation */}\n      <path\n        className=\"edge-arrow\"\n        d={path}\n        fill=\"none\"\n        stroke=\"none\"\n        strokeWidth={strokeWidth}\n        markerEnd=\"url(#arrowhead)\"\n        opacity=\"0\"\n      />\n\n      {/* Label */}\n      {label && (\n        <g>\n          <rect\n            x={midPoint.x - 30}\n            y={midPoint.y - 12}\n            width={60}\n            height={24}\n            fill=\"white\"\n            stroke=\"#e0e0e0\"\n            rx={4}\n          />\n          <text\n            x={midPoint.x}\n            y={midPoint.y}\n            textAnchor=\"middle\"\n            dominantBaseline=\"middle\"\n            fill=\"#424242\"\n            fontSize=\"12\"\n            fontFamily=\"system-ui, sans-serif\"\n          >\n            {label}\n          </text>\n        </g>\n      )}\n    </g>\n  );\n}\n\n/**\n * Arrow marker definition - smaller size\n */\nexport function ArrowMarkerDef() {\n  return (\n    <defs>\n      <marker\n        id=\"arrowhead\"\n        markerWidth=\"5\"\n        markerHeight=\"5\"\n        refX=\"4\"\n        refY=\"1.5\"\n        orient=\"auto\"\n        markerUnits=\"strokeWidth\"\n      >\n        <path d=\"M0,0 L0,3 L4,1.5 z\" fill=\"#757575\" />\n      </marker>\n    </defs>\n  );\n}\n","\"use client\";\n\nimport React, { useRef, useEffect } from \"react\";\nimport rough from \"roughjs\";\nimport type { DiagramNode, NodeShape } from \"../../core/types\";\n\ninterface RoughNodeRendererProps {\n  node: DiagramNode;\n  style?: React.CSSProperties;\n}\n\nexport function RoughNodeRenderer({ node, style }: RoughNodeRendererProps) {\n  const { id, shape, label, subtitle, position, width, height } = node;\n  const groupRef = useRef<SVGGElement>(null);\n\n  if (!position || !width || !height) return null;\n\n  const x = position.x - width / 2;\n  const y = position.y - height / 2;\n\n  // Default styles\n  const fill = node.style?.fill || \"#e3f2fd\";\n  const stroke = node.style?.stroke || \"#2196F3\";\n  const strokeWidth = node.style?.strokeWidth || 2;\n  const textColor = node.style?.color || \"#000000\";\n\n  // Render rough shapes using useEffect\n  useEffect(() => {\n    if (!groupRef.current) return;\n\n    const svg = groupRef.current.closest(\"svg\");\n    if (!svg) return;\n\n    const rc = rough.svg(svg);\n    const roughOptions = {\n      roughness: 0.8,\n      bowing: 0.5,\n      stroke,\n      strokeWidth,\n      fill,\n      fillStyle: \"hachure\" as const,\n      fillWeight: 0.5,\n      hachureAngle: -41,\n      hachureGap: 4,\n    };\n\n    // Clear previous rough elements\n    const existingRough = groupRef.current.querySelector(\".rough-shape\");\n    if (existingRough) {\n      existingRough.remove();\n    }\n\n    let roughElement: SVGElement | null = null;\n\n    switch (shape) {\n      case \"rectangle\":\n        roughElement = rc.rectangle(x, y, width, height, {\n          ...roughOptions,\n          bowing: 0.3,\n        });\n        break;\n\n      case \"terminator\":\n        roughElement = rc.ellipse(\n          x + width / 2,\n          y + height / 2,\n          width,\n          height,\n          roughOptions\n        );\n        break;\n\n      case \"diamond\": {\n        const cx = x + width / 2;\n        const cy = y + height / 2;\n        const points: [number, number][] = [\n          [cx, y],\n          [x + width, cy],\n          [cx, y + height],\n          [x, cy],\n        ];\n        roughElement = rc.polygon(points, roughOptions);\n        break;\n      }\n\n      case \"parallelogram\": {\n        const offset = width * 0.15;\n        const points: [number, number][] = [\n          [x + offset, y],\n          [x + width, y],\n          [x + width - offset, y + height],\n          [x, y + height],\n        ];\n        roughElement = rc.polygon(points, roughOptions);\n        break;\n      }\n\n      case \"database\": {\n        const dbHeight = height * 0.15;\n        // Create a group for database shape\n        const dbGroup = document.createElementNS(\n          \"http://www.w3.org/2000/svg\",\n          \"g\"\n        );\n        dbGroup.classList.add(\"rough-shape\");\n\n        // Top ellipse\n        const topEllipse = rc.ellipse(\n          x + width / 2,\n          y + dbHeight,\n          width,\n          dbHeight * 2,\n          roughOptions\n        );\n        dbGroup.appendChild(topEllipse);\n\n        // Left line\n        const leftLine = rc.line(\n          x,\n          y + dbHeight,\n          x,\n          y + height - dbHeight,\n          roughOptions\n        );\n        dbGroup.appendChild(leftLine);\n\n        // Right line\n        const rightLine = rc.line(\n          x + width,\n          y + dbHeight,\n          x + width,\n          y + height - dbHeight,\n          roughOptions\n        );\n        dbGroup.appendChild(rightLine);\n\n        // Bottom ellipse\n        const bottomEllipse = rc.ellipse(\n          x + width / 2,\n          y + height - dbHeight,\n          width,\n          dbHeight * 2,\n          roughOptions\n        );\n        dbGroup.appendChild(bottomEllipse);\n\n        roughElement = dbGroup;\n        break;\n      }\n\n      case \"document\": {\n        const wavePath = `\n          M ${x} ${y}\n          L ${x + width} ${y}\n          L ${x + width} ${y + height - 10}\n          Q ${x + width * 0.75} ${y + height - 15}, ${x + width / 2} ${y + height - 10}\n          Q ${x + width * 0.25} ${y + height - 5}, ${x} ${y + height - 10}\n          Z\n        `;\n        roughElement = rc.path(wavePath, roughOptions);\n        break;\n      }\n\n      default:\n        roughElement = rc.rectangle(x, y, width, height, roughOptions);\n    }\n\n    if (roughElement) {\n      roughElement.classList.add(\"rough-shape\");\n      groupRef.current.insertBefore(roughElement, groupRef.current.firstChild);\n    }\n\n    // Cleanup function\n    return () => {\n      if (roughElement && roughElement.parentNode) {\n        roughElement.remove();\n      }\n    };\n  }, [shape, x, y, width, height, fill, stroke, strokeWidth]);\n\n  return (\n    <g\n      ref={groupRef}\n      id={`node-${id}`}\n      data-node-id={id}\n      style={{ opacity: 1, ...style }}\n      className=\"node-group\"\n    >\n      {renderText(label, subtitle, position.x, position.y, textColor)}\n    </g>\n  );\n}\n\n/**\n * Render text label with hand-drawn font\n */\nfunction renderText(\n  label: string,\n  subtitle: string | undefined,\n  cx: number,\n  cy: number,\n  color: string\n) {\n  const lines = [label];\n  if (subtitle) {\n    lines.push(...subtitle.split(\"\\n\"));\n  }\n\n  const lineHeight = 20;\n  const startY = cy - ((lines.length - 1) * lineHeight) / 2;\n\n  return (\n    <text\n      x={cx}\n      y={startY}\n      textAnchor=\"middle\"\n      dominantBaseline=\"middle\"\n      fill={color}\n      fontSize=\"15\"\n      fontFamily=\"Comic Neue, Comic Sans MS, cursive\"\n      fontWeight=\"400\"\n    >\n      {lines.map((line, i) => (\n        <tspan key={i} x={cx} dy={i === 0 ? 0 : lineHeight}>\n          {line}\n        </tspan>\n      ))}\n    </text>\n  );\n}\n","\"use client\";\n\nimport React, { useMemo } from \"react\";\nimport rough from \"roughjs/bin/rough\";\nimport type { DiagramEdge } from \"../../core/types\";\nimport { calculateEdgePath } from \"../../core/layout/flowchart-layout\";\n\ninterface RoughEdgeRendererProps {\n  edge: DiagramEdge;\n  style?: React.CSSProperties;\n}\n\nexport function RoughEdgeRenderer({ edge, style }: RoughEdgeRendererProps) {\n  const { id, from, to, label, points, style: edgeStyle } = edge;\n\n  if (!points || points.length < 2) return null;\n\n  const path = calculateEdgePath(points);\n  const stroke = \"#757575\";\n  const strokeWidth = edgeStyle === \"thick\" ? 3 : 2;\n\n  // Calculate label position\n  const midPoint = points[Math.floor(points.length / 2)];\n\n  // Memoize arrow points calculation\n  const arrowData = useMemo(() => {\n    // Guard: need at least 2 valid points\n    if (!points || points.length < 2) {\n      return { points: [] as [number, number][], valid: false };\n    }\n\n    const lastPoint = points[points.length - 1];\n    const secondLastPoint = points[points.length - 2];\n\n    // Validate points\n    if (!lastPoint || !secondLastPoint ||\n        typeof lastPoint.x !== 'number' || typeof lastPoint.y !== 'number' ||\n        typeof secondLastPoint.x !== 'number' || typeof secondLastPoint.y !== 'number' ||\n        isNaN(lastPoint.x) || isNaN(lastPoint.y) ||\n        isNaN(secondLastPoint.x) || isNaN(secondLastPoint.y)) {\n      return { points: [] as [number, number][], valid: false };\n    }\n\n    const angle = Math.atan2(\n      lastPoint.y - secondLastPoint.y,\n      lastPoint.x - secondLastPoint.x\n    );\n    const arrowLength = 10;\n    const arrowWidth = 6;\n    \n    const arrowPoints: [number, number][] = [\n      [lastPoint.x, lastPoint.y],\n      [\n        lastPoint.x - arrowLength * Math.cos(angle) - arrowWidth * Math.sin(angle),\n        lastPoint.y - arrowLength * Math.sin(angle) + arrowWidth * Math.cos(angle),\n      ],\n      [\n        lastPoint.x - arrowLength * Math.cos(angle) + arrowWidth * Math.sin(angle),\n        lastPoint.y - arrowLength * Math.sin(angle) - arrowWidth * Math.cos(angle),\n      ],\n    ];\n\n    // Validate calculated points\n    const allValid = arrowPoints.every(pt => \n      pt.length === 2 && \n      typeof pt[0] === 'number' && typeof pt[1] === 'number' &&\n      !isNaN(pt[0]) && !isNaN(pt[1])\n    );\n\n    return { \n      points: allValid ? arrowPoints : [] as [number, number][], \n      valid: allValid \n    };\n  }, [points]);\n\n  // Generate rough paths at render time (NOT in useEffect!)\n  const roughPaths = useMemo(() => {\n    // Guard: path must be valid\n    if (!path || path === \"\" || typeof path !== \"string\" || path.includes(\"NaN\")) {\n      return { pathOps: [], arrowOps: [] };\n    }\n\n    // Guard: arrow data must be valid\n    if (!arrowData.valid || arrowData.points.length === 0) {\n      return { pathOps: [], arrowOps: [] };\n    }\n\n    try {\n      const generator = rough.generator();\n      \n      const roughOptions = {\n        roughness: 0.6,\n        bowing: 0.3,\n        stroke,\n        strokeWidth,\n        disableMultiStroke: edgeStyle === \"dashed\",\n        strokeLineDash: edgeStyle === \"dashed\" ? [8, 8] : undefined,\n      };\n\n      // Generate rough path drawable\n      const roughPathDrawable = generator.path(path, roughOptions);\n      \n      // Generate rough arrow drawable\n      const roughArrowDrawable = generator.polygon(arrowData.points, {\n        roughness: 0.6,\n        bowing: 0.3,\n        stroke,\n        strokeWidth: 1,\n        fill: stroke,\n        fillStyle: \"solid\",\n      });\n\n      return {\n        pathOps: roughPathDrawable.sets || [],\n        arrowOps: roughArrowDrawable.sets || [],\n      };\n    } catch (error) {\n      console.error(\"Error generating rough paths:\", error, { path, arrowData });\n      return { pathOps: [], arrowOps: [] };\n    }\n  }, [path, stroke, strokeWidth, edgeStyle, arrowData]);\n\n  return (\n    <g\n      id={`edge-${id}`}\n      data-edge-id={id}\n      data-from={from}\n      data-to={to}\n      style={{ opacity: 0, ...style }}\n      className=\"edge-group\"\n    >\n      {/* Hidden path for GSAP getTotalLength() */}\n      <path\n        className=\"edge-path\"\n        d={path}\n        fill=\"none\"\n        stroke=\"none\"\n        opacity={0}\n        pointerEvents=\"none\"\n      />\n\n      {/* Rough path - rendered directly in JSX */}\n      {roughPaths.pathOps.length > 0 && (\n        <g className=\"rough-path-container\" style={{ opacity: 0 }}>\n          {roughPaths.pathOps.map((set, i) => (\n            <path\n              key={`path-${i}`}\n              d={opsToPath(set)}\n              stroke={stroke}\n              strokeWidth={strokeWidth}\n              fill=\"none\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            />\n          ))}\n        </g>\n      )}\n\n      {/* Rough arrow - rendered directly in JSX */}\n      {roughPaths.arrowOps.length > 0 && (\n        <g className=\"rough-arrow-overlay\" style={{ opacity: 0 }}>\n          {roughPaths.arrowOps.map((set, i) => (\n            <path\n              key={`arrow-${i}`}\n              d={opsToPath(set)}\n              stroke={set.type === \"fillPath\" ? \"none\" : stroke}\n              fill={set.type === \"fillPath\" ? stroke : \"none\"}\n              strokeWidth={1}\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            />\n          ))}\n        </g>\n      )}\n\n      {/* Label */}\n      {label && (\n        <g>\n          <rect\n            x={midPoint.x - 30}\n            y={midPoint.y - 12}\n            width={60}\n            height={24}\n            fill=\"white\"\n            stroke=\"#e0e0e0\"\n            strokeWidth={1}\n            rx={4}\n            opacity={0.9}\n          />\n          <text\n            x={midPoint.x}\n            y={midPoint.y}\n            textAnchor=\"middle\"\n            dominantBaseline=\"middle\"\n            fill=\"#424242\"\n            fontSize=\"13\"\n            fontFamily=\"Comic Neue, Comic Sans MS, cursive\"\n            fontWeight=\"400\"\n          >\n            {label}\n          </text>\n        </g>\n      )}\n    </g>\n  );\n}\n\n/**\n * Convert rough.js ops to SVG path data\n */\nfunction opsToPath(set: any): string {\n  const ops = set.ops;\n  let pathData = \"\";\n  \n  for (const op of ops) {\n    const data = op.data;\n    switch (op.op) {\n      case \"move\":\n        pathData += `M ${data[0]} ${data[1]} `;\n        break;\n      case \"bcurveTo\":\n        pathData += `C ${data[0]} ${data[1]}, ${data[2]} ${data[3]}, ${data[4]} ${data[5]} `;\n        break;\n      case \"lineTo\":\n        pathData += `L ${data[0]} ${data[1]} `;\n        break;\n    }\n  }\n  \n  return pathData;\n}\n","\"use client\";\n\nimport React, { useRef, useEffect, useMemo } from \"react\";\nimport type { DiagramData } from \"../../core/types\";\nimport { NodeRenderer } from \"./NodeRenderer\";\nimport { EdgeRenderer, ArrowMarkerDef } from \"./EdgeRenderer\";\nimport { RoughNodeRenderer } from \"./RoughNodeRenderer\";\nimport { RoughEdgeRenderer } from \"./RoughEdgeRenderer\";\n\ninterface DiagramRendererProps {\n  data: DiagramData;\n  onReady?: (svgElement: SVGSVGElement) => void;\n  renderMode?: \"clean\" | \"sketchy\";\n  zoom?: number;\n  pan?: { x: number; y: number };\n}\n\nexport function DiagramRenderer({\n  data,\n  onReady,\n  renderMode = \"clean\",\n  zoom = 1,\n  pan = { x: 0, y: 0 },\n}: DiagramRendererProps) {\n  const svgRef = useRef<SVGSVGElement>(null);\n\n  useEffect(() => {\n    if (svgRef.current && onReady) {\n      onReady(svgRef.current);\n    }\n  }, [data, onReady]);\n\n  const bounds = useMemo(() => calculateDiagramBounds(data), [data]);\n  const viewBox = useMemo(\n    () => calculateViewBox(bounds, zoom, pan),\n    [bounds, zoom, pan]\n  );\n\n  // Background color based on render mode\n  const background = renderMode === \"sketchy\" \n    ? \"#faf9f6\" \n    : (data.config.background || \"#ffffff\");\n\n  const edgesLayer = useMemo(\n    () =>\n      data.edges.map((edge) =>\n        renderMode === \"clean\" ? (\n          <EdgeRenderer key={edge.id} edge={edge} />\n        ) : (\n          <RoughEdgeRenderer key={edge.id} edge={edge} />\n        )\n      ),\n    [data.edges, renderMode]\n  );\n\n  const nodesLayer = useMemo(\n    () =>\n      data.nodes.map((node) =>\n        renderMode === \"clean\" ? (\n          <NodeRenderer key={node.id} node={node} />\n        ) : (\n          <RoughNodeRenderer key={node.id} node={node} />\n        )\n      ),\n    [data.nodes, renderMode]\n  );\n\n  return (\n    <svg\n      ref={svgRef}\n      className=\"diagram-svg w-full h-full\"\n      viewBox={viewBox}\n      xmlns=\"http://www.w3.org/2000/svg\"\n      style={{ background }}\n    >\n      {renderMode === \"clean\" && <ArrowMarkerDef />}\n\n      {/* Render edges first (behind nodes) */}\n      <g className=\"edges-layer\">{edgesLayer}</g>\n\n      {/* Render nodes */}\n      <g className=\"nodes-layer\">{nodesLayer}</g>\n    </svg>\n  );\n}\n\n/**\n * Calculate SVG viewBox based on node positions\n */\nfunction calculateDiagramBounds(data: DiagramData): {\n  minX: number;\n  minY: number;\n  width: number;\n  height: number;\n} {\n  const nodes = data.nodes;\n  if (nodes.length === 0) {\n    return { minX: 0, minY: 0, width: 800, height: 600 };\n  }\n\n  let minX = Infinity;\n  let minY = Infinity;\n  let maxX = -Infinity;\n  let maxY = -Infinity;\n\n  for (const node of nodes) {\n    if (!node.position || !node.width || !node.height) continue;\n\n    const x1 = node.position.x - node.width / 2;\n    const y1 = node.position.y - node.height / 2;\n    const x2 = node.position.x + node.width / 2;\n    const y2 = node.position.y + node.height / 2;\n\n    minX = Math.min(minX, x1);\n    minY = Math.min(minY, y1);\n    maxX = Math.max(maxX, x2);\n    maxY = Math.max(maxY, y2);\n  }\n\n  if (!Number.isFinite(minX) || !Number.isFinite(minY) || !Number.isFinite(maxX) || !Number.isFinite(maxY)) {\n    return { minX: 0, minY: 0, width: 800, height: 600 };\n  }\n\n  // Add padding\n  const padding = 50;\n  minX -= padding;\n  minY -= padding;\n  maxX += padding;\n  maxY += padding;\n\n  const width = maxX - minX;\n  const height = maxY - minY;\n\n  return { minX, minY, width, height };\n}\n\nfunction calculateViewBox(\n  bounds: { minX: number; minY: number; width: number; height: number },\n  zoom: number = 1,\n  pan: { x: number; y: number } = { x: 0, y: 0 }\n): string {\n  const { minX, minY, width, height } = bounds;\n\n  // Zoom by shrinking/expanding viewBox around center.\n  const safeZoom = Math.max(0.5, Math.min(2, zoom));\n  const centerX = minX + width / 2;\n  const centerY = minY + height / 2;\n  const zoomedWidth = width / safeZoom;\n  const zoomedHeight = height / safeZoom;\n  const zoomedMinX = centerX - zoomedWidth / 2;\n  const zoomedMinY = centerY - zoomedHeight / 2;\n\n  // Pan by moving the camera(viewBox), not by translating the SVG element.\n  // This keeps a single continuous canvas/background during drag.\n  const panX = Number.isFinite(pan.x) ? pan.x : 0;\n  const panY = Number.isFinite(pan.y) ? pan.y : 0;\n  const pannedMinX = zoomedMinX - panX;\n  const pannedMinY = zoomedMinY - panY;\n\n  return `${pannedMinX} ${pannedMinY} ${zoomedWidth} ${zoomedHeight}`;\n}\n","\"use client\";\n\nimport React from \"react\";\nimport type { NarrationItem } from \"../../core/types\";\n\ninterface NarrationOverlayProps {\n  narration: NarrationItem | null;\n}\n\nexport function NarrationOverlay({ narration }: NarrationOverlayProps) {\n  if (!narration) return null;\n\n  return (\n    <div className=\"relative border-t border-gray-200 bg-gray-50/95 px-4 py-3\">\n      <div className=\"mx-auto max-w-5xl\">\n        <h3 className=\"text-base font-semibold text-gray-900 mb-1\">\n          {narration.title}\n        </h3>\n        <p className=\"text-sm text-gray-700 leading-relaxed\">{narration.text}</p>\n      </div>\n    </div>\n  );\n}\n","import { create } from \"zustand\";\nimport type { DiagramData, NarrationItem } from \"../core/types\";\n\ninterface DiagramStore {\n  // Diagram data\n  diagramData: DiagramData | null;\n  setDiagramData: (data: DiagramData | null) => void;\n\n  // Playback state\n  isPlaying: boolean;\n  currentStep: number;\n  currentTime: number;\n  duration: number;\n  speed: number;\n\n  setIsPlaying: (playing: boolean) => void;\n  setCurrentStep: (step: number) => void;\n  setCurrentTime: (time: number) => void;\n  setDuration: (duration: number) => void;\n  setSpeed: (speed: number) => void;\n\n  // Narration\n  currentNarration: NarrationItem | null;\n  setCurrentNarration: (narration: NarrationItem | null) => void;\n\n  // Render mode\n  renderMode: \"clean\" | \"sketchy\";\n  setRenderMode: (mode: \"clean\" | \"sketchy\") => void;\n}\n\nexport const useDiagramStore = create<DiagramStore>((set) => ({\n  // Initial state\n  diagramData: null,\n  isPlaying: false,\n  currentStep: 0,\n  currentTime: 0,\n  duration: 0,\n  speed: 1.0,\n  currentNarration: null,\n  renderMode: \"sketchy\", //   \n\n  // Actions\n  setDiagramData: (data) => set({ diagramData: data }),\n  setIsPlaying: (playing) => set({ isPlaying: playing }),\n  setCurrentStep: (step) => set({ currentStep: step }),\n  setCurrentTime: (time) => set({ currentTime: time }),\n  setDuration: (duration) => set({ duration }),\n  setSpeed: (speed) => set({ speed }),\n  setCurrentNarration: (narration) => set({ currentNarration: narration }),\n  setRenderMode: (mode) => set({ renderMode: mode }),\n}));\n","\"use client\";\n\nimport React from \"react\";\nimport { useDiagramStore } from \"../../store/diagram-store\";\n\ninterface PlaybackControlsProps {\n  onPlay: () => void;\n  onPause: () => void;\n  onSpeedChange: (speed: number) => void;\n  onSeekToTime: (time: number) => void;\n  stepBoundaries: { step: number; start: number; end: number }[];\n  stepDetails?: Record<number, { title?: string; text?: string }>;\n}\n\nexport function PlaybackControls({\n  onPlay,\n  onPause,\n  onSpeedChange,\n  onSeekToTime,\n  stepBoundaries,\n  stepDetails = {},\n}: PlaybackControlsProps) {\n  const { isPlaying, currentTime, duration, speed } = useDiagramStore();\n  const progressBarRef = React.useRef<HTMLDivElement | null>(null);\n  const [hoverPercent, setHoverPercent] = React.useState<number | null>(null);\n  const [hoverSegmentStep, setHoverSegmentStep] = React.useState<number | null>(null);\n  const [hoverTooltipX, setHoverTooltipX] = React.useState<number | null>(null);\n\n  const formatTime = (time: number): string => {\n    const minutes = Math.floor(time / 60);\n    const seconds = Math.floor(time % 60);\n    return `${minutes}:${seconds.toString().padStart(2, \"0\")}`;\n  };\n\n  const progress = duration > 0 ? (currentTime / duration) * 100 : 0;\n  const clampedProgress = Math.max(0, Math.min(100, progress));\n  const isHoveringBar = hoverPercent !== null;\n  const previewStart = Math.min(clampedProgress, hoverPercent ?? clampedProgress);\n  const previewEnd = Math.max(clampedProgress, hoverPercent ?? clampedProgress);\n  const previewWidth = Math.max(0, previewEnd - previewStart);\n\n  const handleBarMouseMove = (e: React.MouseEvent<HTMLDivElement>) => {\n    if (!progressBarRef.current || duration <= 0) return;\n    const rect = progressBarRef.current.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const percent = Math.max(0, Math.min(100, (x / rect.width) * 100));\n    setHoverPercent(percent);\n  };\n\n  const handleBarMouseLeave = () => {\n    setHoverPercent(null);\n    setHoverSegmentStep(null);\n    setHoverTooltipX(null);\n  };\n\n  return (\n    <div className=\"bg-white border-t border-gray-200 p-4\">\n      <div className=\"max-w-5xl mx-auto space-y-3\">\n        {/* YouTube-like control row */}\n        <div className=\"flex items-center gap-3\">\n          {/* Play/Pause */}\n          {!isPlaying ? (\n            <button\n              onClick={onPlay}\n              className=\"shrink-0 p-2 rounded-full text-gray-900 bg-white border border-gray-300 shadow-sm hover:bg-gray-50 transition-colors\"\n              title=\"\"\n              aria-label=\"\"\n            >\n              <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path d=\"M8 5v14l11-7z\" />\n              </svg>\n            </button>\n          ) : (\n            <button\n              onClick={onPause}\n              className=\"shrink-0 p-2 rounded-full text-gray-900 bg-white border border-gray-300 shadow-sm hover:bg-gray-50 transition-colors\"\n              title=\"\"\n              aria-label=\"\"\n            >\n              <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path d=\"M6 4h4v16H6V4zm8 0h4v16h-4V4z\" />\n              </svg>\n            </button>\n          )}\n\n          {/* Step Progress Bar (clickable chapters) */}\n          <div className=\"relative flex-1\">\n          {hoverSegmentStep !== null &&\n            hoverTooltipX !== null &&\n            (stepDetails[hoverSegmentStep]?.title ||\n              stepDetails[hoverSegmentStep]?.text) && (\n            <div\n              className=\"pointer-events-none absolute -top-16 z-40 max-w-xs -translate-x-1/2 rounded-md bg-gray-900 px-3 py-2 text-xs text-white shadow-lg\"\n              style={{ left: `${hoverTooltipX}px` }}\n            >\n              {stepDetails[hoverSegmentStep]?.title && (\n                <div className=\"font-semibold\">\n                  {stepDetails[hoverSegmentStep]?.title}\n                </div>\n              )}\n              {stepDetails[hoverSegmentStep]?.text && (\n                <div className=\"mt-1 line-clamp-2 text-gray-200\">\n                  {stepDetails[hoverSegmentStep]?.text}\n                </div>\n              )}\n            </div>\n          )}\n            {stepBoundaries.length > 0 ? (\n            <div\n              ref={progressBarRef}\n              className=\"relative h-3 rounded-full bg-gray-200 p-[1px] transition-all duration-150 hover:h-4\"\n              onMouseMove={handleBarMouseMove}\n              onMouseLeave={handleBarMouseLeave}\n            >\n              {/* Hover preview range: current dot <-> hover point */}\n              {isHoveringBar && previewWidth > 0 && (\n                <div\n                  className=\"pointer-events-none absolute top-[1px] bottom-[1px] rounded bg-gray-400/50 z-20\"\n                  style={{\n                    left: `${previewStart}%`,\n                    width: `${previewWidth}%`,\n                  }}\n                />\n              )}\n\n              <div className=\"h-full w-full flex gap-[2px]\">\n              {stepBoundaries.map((segment, index) => {\n                const segmentDuration = Math.max(\n                  0.001,\n                  segment.end - segment.start\n                );\n                const playedRatio = Math.max(\n                  0,\n                  Math.min(\n                    1,\n                    (currentTime - segment.start) / Math.max(0.001, segmentDuration)\n                  )\n                );\n                return (\n                  <button\n                    key={`${segment.step}-${index}`}\n                    onClick={() => onSeekToTime(segment.start)}\n                    onMouseEnter={(e) => {\n                      setHoverSegmentStep(segment.step);\n                      if (progressBarRef.current) {\n                        const barRect = progressBarRef.current.getBoundingClientRect();\n                        const targetRect = (e.currentTarget as HTMLButtonElement).getBoundingClientRect();\n                        setHoverTooltipX(targetRect.left - barRect.left + targetRect.width / 2);\n                      }\n                    }}\n                    className={`relative h-full min-w-[10px] rounded-[2px] bg-gray-300/90 transition-all duration-150 origin-center overflow-hidden border border-white/90 ${\n                      hoverSegmentStep === segment.step ? \"scale-y-125\" : \"\"\n                    }`}\n                    style={{ flexGrow: segmentDuration }}\n                    title={\n                      stepDetails[segment.step]?.title\n                        ? `${stepDetails[segment.step]?.title} `\n                        : `step ${segment.step} `\n                    }\n                    aria-label={\n                      stepDetails[segment.step]?.title\n                        ? `${stepDetails[segment.step]?.title} `\n                        : `step ${segment.step} `\n                    }\n                  >\n                    <div\n                      className=\"h-full bg-primary transition-[width] duration-100 ease-linear\"\n                      style={{ width: `${playedRatio * 100}%` }}\n                    />\n                  </button>\n                );\n              })}\n              </div>\n\n              {/* Current playhead */}\n              <div\n                className=\"pointer-events-none absolute top-1/2 z-30 h-3.5 w-3.5 -translate-y-1/2 rounded-full bg-white border-2 border-primary shadow transition-all duration-100 ease-linear\"\n                style={{\n                  left: `calc(${clampedProgress}% - 7px)`,\n                }}\n              />\n            </div>\n            ) : (\n            <div\n              ref={progressBarRef}\n              className=\"relative h-3 rounded-full bg-gray-200 overflow-hidden transition-all duration-150 hover:h-4\"\n              onMouseMove={handleBarMouseMove}\n              onMouseLeave={handleBarMouseLeave}\n            >\n              <div\n                className=\"h-full bg-primary transition-all duration-200\"\n                style={{ width: `${clampedProgress}%` }}\n              />\n              {isHoveringBar && previewWidth > 0 && (\n                <div\n                  className=\"pointer-events-none absolute top-0 bottom-0 rounded bg-gray-400/50 z-20\"\n                  style={{\n                    left: `${previewStart}%`,\n                    width: `${previewWidth}%`,\n                  }}\n                />\n              )}\n              <div\n                className=\"pointer-events-none absolute top-1/2 z-30 h-3.5 w-3.5 -translate-y-1/2 rounded-full bg-white border-2 border-primary shadow transition-all duration-100 ease-linear\"\n                style={{\n                  left: `calc(${clampedProgress}% - 7px)`,\n                }}\n              />\n            </div>\n            )}\n            <div className=\"flex justify-between text-[11px] text-gray-500 mt-1\">\n              <span>{formatTime(currentTime)}</span>\n              <span>{formatTime(duration)}</span>\n            </div>\n          </div>\n\n        </div>\n      </div>\n    </div>\n  );\n}\n","\"use client\";\n\nimport React, { useRef, useEffect, useState, useCallback, useMemo, useImperativeHandle, forwardRef } from \"react\";\nimport { parseDsl } from \"../core/parser/dsl-parser\";\nimport { calculateFlowchartLayout } from \"../core/layout/flowchart-layout\";\nimport { AnimationTimeline } from \"../core/animation/timeline\";\nimport { DiagramRenderer } from \"./renderer/DiagramRenderer\";\nimport { NarrationOverlay } from \"./renderer/NarrationOverlay\";\nimport { PlaybackControls } from \"./controls/PlaybackControls\";\nimport { useDiagramStore } from \"../store/diagram-store\";\nimport type { DiagramData } from \"../core/types\";\n\nexport interface AnimflowPlayerProps {\n  dsl: string;\n  mode?: \"clean\" | \"sketchy\";\n  autoplay?: boolean;\n  controls?: boolean;\n  narration?: boolean;\n  className?: string;\n  onError?: (error: string) => void;\n  onReady?: (data: DiagramData) => void;\n}\n\nexport interface AnimflowPlayerRef {\n  play: () => void;\n  pause: () => void;\n  stop: () => void;\n  seek: (time: number) => void;\n  setSpeed: (speed: number) => void;\n  restart: () => void;\n  getCurrentTime: () => number;\n  getDuration: () => number;\n  isPlaying: () => boolean;\n}\n\nexport const AnimflowPlayer = forwardRef<AnimflowPlayerRef, AnimflowPlayerProps>(\n  function AnimflowPlayer(\n    {\n      dsl,\n      mode = \"sketchy\",\n      autoplay = false,\n      controls = true,\n      narration = true,\n      className = \"\",\n      onError,\n      onReady,\n    },\n    ref\n  ) {\n    const svgRef = useRef<SVGSVGElement | null>(null);\n    const panStartRef = useRef<{\n      clientX: number;\n      clientY: number;\n      panX: number;\n      panY: number;\n    } | null>(null);\n    const timelineRef = useRef<AnimationTimeline | null>(null);\n    const intervalRef = useRef<NodeJS.Timeout | null>(null);\n    const isDraggingRef = useRef(false);\n    const panRafRef = useRef<number | null>(null);\n    const pendingPanRef = useRef<{ x: number; y: number } | null>(null);\n    const [error, setError] = useState<string | null>(null);\n    const [localDiagramData, setLocalDiagramData] = useState<DiagramData | null>(null);\n    const [zoomLevel, setZoomLevel] = useState(1);\n    const [panOffset, setPanOffset] = useState({ x: 0, y: 0 });\n    const [isDragging, setIsDragging] = useState(false);\n    const [stepBoundaries, setStepBoundaries] = useState<\n      { step: number; start: number; end: number }[]\n    >([]);\n\n    const narrationStepDetails = useMemo(() => {\n      if (!localDiagramData) return {};\n      const details: Record<number, { title?: string; text?: string }> = {};\n\n      for (const narration of localDiagramData.narrations) {\n        const title =\n          typeof narration.title === \"string\" && narration.title.trim().length > 0\n            ? narration.title.trim()\n            : undefined;\n        const text =\n          typeof narration.text === \"string\" && narration.text.trim().length > 0\n            ? narration.text.trim()\n            : undefined;\n\n        if (title || text) {\n          details[narration.step] = { title, text };\n        }\n      }\n\n      return details;\n    }, [localDiagramData]);\n\n    const narrationBoundaries = useMemo(() => {\n      if (!localDiagramData || stepBoundaries.length === 0) return stepBoundaries;\n\n      const sortedNarrationSteps = Array.from(\n        new Set(localDiagramData.narrations.map((n) => n.step))\n      )\n        .sort((a, b) => a - b)\n        .filter((step) => stepBoundaries.some((b) => b.step === step));\n\n      if (sortedNarrationSteps.length === 0) {\n        return stepBoundaries;\n      }\n\n      const segments: { step: number; start: number; end: number }[] = [];\n      const lastTimelineEnd = stepBoundaries[stepBoundaries.length - 1]?.end ?? 0;\n\n      for (let i = 0; i < sortedNarrationSteps.length; i += 1) {\n        const step = sortedNarrationSteps[i];\n        const current = stepBoundaries.find((b) => b.step === step);\n        if (!current) continue;\n\n        const nextNarrationStep = sortedNarrationSteps[i + 1];\n        const next = nextNarrationStep\n          ? stepBoundaries.find((b) => b.step === nextNarrationStep)\n          : undefined;\n\n        const start = current.start;\n        const end = next?.start ?? lastTimelineEnd;\n        segments.push({\n          step,\n          start,\n          end: end > start ? end : current.end,\n        });\n      }\n\n      return segments.length > 0 ? segments : stepBoundaries;\n    }, [localDiagramData, stepBoundaries]);\n\n    const {\n      setDuration,\n      setCurrentTime,\n      setCurrentStep,\n      setIsPlaying,\n      currentNarration,\n      setCurrentNarration,\n      renderMode,\n      setRenderMode,\n    } = useDiagramStore();\n\n    // Sync mode prop with store\n    useEffect(() => {\n      setRenderMode(mode);\n    }, [mode, setRenderMode]);\n\n    // Parse DSL and create diagram\n    useEffect(() => {\n      if (!dsl.trim()) {\n        setLocalDiagramData(null);\n        setError(null);\n        return;\n      }\n\n      try {\n        const parseResult = parseDsl(dsl);\n        \n        if (!parseResult.success || !parseResult.data) {\n          const errorMsg = \"DSL  \";\n          setError(errorMsg);\n          onError?.(errorMsg);\n          return;\n        }\n\n        let data = parseResult.data;\n\n        const { nodes, edges } = calculateFlowchartLayout(\n          data.nodes,\n          data.edges,\n          data.metadata.direction\n        );\n\n        data = {\n          ...data,\n          nodes,\n          edges,\n          config: {\n            ...data.config,\n            autoplay: autoplay ?? data.config.autoplay,\n            controls: controls ?? data.config.controls,\n            narration: narration ?? data.config.narration,\n          },\n        };\n\n        setLocalDiagramData(data);\n        setError(null);\n        onReady?.(data);\n      } catch (err) {\n        const errorMsg = err instanceof Error ? err.message : \"   \";\n        setError(errorMsg);\n        onError?.(errorMsg);\n      }\n    }, [dsl, autoplay, controls, narration, onError, onReady]);\n\n    // Build animation timeline\n    useEffect(() => {\n      if (!svgRef.current || !localDiagramData) return;\n\n      if (timelineRef.current) {\n        timelineRef.current.pause();\n      }\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n\n      if (!svgRef.current) return;\n\n      const timeline = new AnimationTimeline(localDiagramData, {\n        onStepChange: (step) => {\n          setCurrentStep(step);\n          const narrationForStep =\n            localDiagramData.narrations.find((n) => n.step === step) || null;\n          if (narrationForStep) {\n            setCurrentNarration(narrationForStep);\n          }\n        },\n      });\n      timeline.buildTimeline(svgRef.current);\n      timelineRef.current = timeline;\n      setStepBoundaries(timeline.getStepBoundaries());\n\n      setDuration(timeline.getDuration());\n\n      if (localDiagramData.config.autoplay) {\n        timeline.play();\n        setIsPlaying(true);\n      }\n\n      intervalRef.current = setInterval(() => {\n        if (timelineRef.current) {\n          if (isDraggingRef.current) return;\n          const time = timelineRef.current.getCurrentTime();\n          const duration = timelineRef.current.getDuration();\n          setCurrentTime(time);\n\n          if (duration > 0 && time >= duration - 0.01 && !timelineRef.current.isPlaying()) {\n            setIsPlaying(false);\n          }\n        }\n      }, 33);\n\n      if (localDiagramData.narrations.length > 0) {\n        setCurrentNarration(localDiagramData.narrations[0]);\n      }\n\n      return () => {\n        if (intervalRef.current) {\n          clearInterval(intervalRef.current);\n        }\n      };\n    }, [\n      localDiagramData,\n      renderMode,\n      setDuration,\n      setCurrentTime,\n      setCurrentStep,\n      setIsPlaying,\n      setCurrentNarration,\n    ]);\n\n    useEffect(() => {\n      return () => {\n        if (panRafRef.current !== null) {\n          window.cancelAnimationFrame(panRafRef.current);\n          panRafRef.current = null;\n        }\n      };\n    }, []);\n\n    const handleSvgReady = useCallback((svg: SVGSVGElement) => {\n      svgRef.current = svg;\n    }, []);\n\n    const handlePlay = useCallback(() => {\n      if (timelineRef.current) {\n        const current = timelineRef.current.getCurrentTime();\n        const duration = timelineRef.current.getDuration();\n        const isAtEnd = duration > 0 && current >= duration - 0.01;\n\n        if (isAtEnd) {\n          timelineRef.current.restart();\n        }\n        timelineRef.current.play();\n        setIsPlaying(true);\n      }\n    }, [setIsPlaying]);\n\n    const handlePause = useCallback(() => {\n      if (timelineRef.current) {\n        timelineRef.current.pause();\n        setIsPlaying(false);\n      }\n    }, [setIsPlaying]);\n\n    const handleStop = useCallback(() => {\n      if (timelineRef.current) {\n        timelineRef.current.stop();\n        setIsPlaying(false);\n        setCurrentTime(0);\n      }\n    }, [setIsPlaying, setCurrentTime]);\n\n    const handleSpeedChange = useCallback((speed: number) => {\n      if (timelineRef.current) {\n        timelineRef.current.setSpeed(speed);\n      }\n    }, []);\n\n    const handleSeekToTime = useCallback((time: number) => {\n      if (!timelineRef.current || !localDiagramData) return;\n      timelineRef.current.seek(time);\n      setCurrentTime(time);\n\n      const matched =\n        stepBoundaries.find((b) => time >= b.start && time <= b.end) ||\n        stepBoundaries.find((b) => time < b.start) ||\n        null;\n\n      if (matched) {\n        setCurrentStep(matched.step);\n        const narrationForStep =\n          localDiagramData.narrations.find((n) => n.step === matched.step) || null;\n        if (narrationForStep) {\n          setCurrentNarration(narrationForStep);\n        }\n      }\n    }, [localDiagramData, stepBoundaries, setCurrentTime, setCurrentStep, setCurrentNarration]);\n\n    const handleZoomIn = useCallback(() => {\n      setZoomLevel((prev) => Math.min(2, Number((prev + 0.1).toFixed(1))));\n    }, []);\n\n    const handleZoomOut = useCallback(() => {\n      setZoomLevel((prev) => Math.max(0.5, Number((prev - 0.1).toFixed(1))));\n    }, []);\n\n    const handleZoomReset = useCallback(() => {\n      setZoomLevel(1);\n      setPanOffset({ x: 0, y: 0 });\n    }, []);\n\n    const handlePointerDown = useCallback((e: React.MouseEvent<HTMLDivElement>) => {\n      if (e.button !== 0) return;\n      e.preventDefault();\n      isDraggingRef.current = true;\n      setIsDragging(true);\n      panStartRef.current = {\n        clientX: e.clientX,\n        clientY: e.clientY,\n        panX: panOffset.x,\n        panY: panOffset.y,\n      };\n    }, [panOffset]);\n\n    const handlePointerMove = useCallback((e: React.MouseEvent<HTMLDivElement>) => {\n      if (!isDraggingRef.current || !panStartRef.current) return;\n      e.preventDefault();\n      const safeZoom = Math.max(0.5, Math.min(2, zoomLevel));\n      const dx = e.clientX - panStartRef.current.clientX;\n      const dy = e.clientY - panStartRef.current.clientY;\n      const nextPan = {\n        x: panStartRef.current.panX + dx / safeZoom,\n        y: panStartRef.current.panY + dy / safeZoom,\n      };\n\n      pendingPanRef.current = nextPan;\n      if (panRafRef.current === null) {\n        panRafRef.current = window.requestAnimationFrame(() => {\n          if (pendingPanRef.current) {\n            setPanOffset(pendingPanRef.current);\n          }\n          panRafRef.current = null;\n        });\n      }\n    }, [zoomLevel]);\n\n    const handleWheel = useCallback((e: React.WheelEvent<HTMLDivElement>) => {\n      if (e.metaKey || e.ctrlKey) {\n        e.preventDefault();\n        const delta = e.deltaY > 0 ? -0.1 : 0.1;\n        setZoomLevel((prev) => Math.max(0.5, Math.min(2, Number((prev + delta).toFixed(1)))));\n      } else {\n        setPanOffset((prev) => ({\n          x: prev.x - e.deltaX,\n          y: prev.y - e.deltaY,\n        }));\n      }\n    }, []);\n\n    const handlePointerUp = useCallback(() => {\n      if (pendingPanRef.current) {\n        setPanOffset(pendingPanRef.current);\n        pendingPanRef.current = null;\n      }\n      if (panRafRef.current !== null) {\n        window.cancelAnimationFrame(panRafRef.current);\n        panRafRef.current = null;\n      }\n      isDraggingRef.current = false;\n      if (timelineRef.current) {\n        setCurrentTime(timelineRef.current.getCurrentTime());\n      }\n      setIsDragging(false);\n      panStartRef.current = null;\n    }, [setCurrentTime]);\n\n    // Expose imperative methods via ref\n    useImperativeHandle(ref, () => ({\n      play: handlePlay,\n      pause: handlePause,\n      stop: handleStop,\n      seek: handleSeekToTime,\n      setSpeed: handleSpeedChange,\n      restart: () => {\n        if (timelineRef.current) {\n          timelineRef.current.restart();\n          setIsPlaying(true);\n        }\n      },\n      getCurrentTime: () => timelineRef.current?.getCurrentTime() ?? 0,\n      getDuration: () => timelineRef.current?.getDuration() ?? 0,\n      isPlaying: () => timelineRef.current?.isPlaying() ?? false,\n    }), [handlePlay, handlePause, handleStop, handleSeekToTime, handleSpeedChange, setIsPlaying]);\n\n    if (error) {\n      return (\n        <div className={`flex items-center justify-center h-full bg-red-50 ${className}`}>\n          <div className=\"text-center\">\n            <p className=\"text-red-600 font-semibold mb-2\"> </p>\n            <p className=\"text-gray-600\">{error}</p>\n          </div>\n        </div>\n      );\n    }\n\n    if (!localDiagramData) {\n      return (\n        <div className={`flex items-center justify-center h-full bg-gray-50 ${className}`}>\n          <p className=\"text-gray-400\"> ...</p>\n        </div>\n      );\n    }\n\n    const canvasBackground =\n      renderMode === \"sketchy\"\n        ? \"#faf9f6\"\n        : localDiagramData.config.background || \"#ffffff\";\n\n    return (\n      <div className={`relative h-full flex flex-col ${className}`}>\n        {/* Zoom Controls */}\n        <div className=\"absolute top-4 left-4 z-10 flex flex-col gap-2\">\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={handleZoomOut}\n              className=\"px-3 py-2 rounded-lg bg-white text-gray-700 hover:bg-gray-50 border border-gray-300 shadow-md text-sm font-medium\"\n              title=\"\"\n            >\n              -\n            </button>\n            <button\n              onClick={handleZoomIn}\n              className=\"px-3 py-2 rounded-lg bg-white text-gray-700 hover:bg-gray-50 border border-gray-300 shadow-md text-sm font-medium\"\n              title=\"\"\n            >\n              +\n            </button>\n            <button\n              onClick={handleZoomReset}\n              className=\"px-3 py-2 rounded-lg bg-white text-gray-700 hover:bg-gray-50 border border-gray-300 shadow-md text-sm font-medium\"\n              title=\" \"\n            >\n              {Math.round(zoomLevel * 100)}%\n            </button>\n          </div>\n        </div>\n\n        {/* Diagram */}\n        <div\n          className={`flex-1 overflow-hidden select-none ${\n            isDragging ? \"cursor-grabbing\" : \"cursor-grab\"\n          }`}\n          style={{ background: canvasBackground }}\n          onMouseDown={handlePointerDown}\n          onMouseMove={handlePointerMove}\n          onMouseUp={handlePointerUp}\n          onMouseLeave={handlePointerUp}\n          onWheel={handleWheel}\n          onDragStart={(e) => e.preventDefault()}\n        >\n          <DiagramRenderer\n            data={localDiagramData}\n            onReady={handleSvgReady}\n            renderMode={renderMode}\n            zoom={zoomLevel}\n            pan={panOffset}\n          />\n        </div>\n\n        {/* Narration Overlay */}\n        {localDiagramData.config.narration !== false && narration && (\n          <NarrationOverlay narration={currentNarration} />\n        )}\n\n        {/* Playback Controls */}\n        {localDiagramData.config.controls !== false && controls && (\n          <PlaybackControls\n            onPlay={handlePlay}\n            onPause={handlePause}\n            onSpeedChange={handleSpeedChange}\n            onSeekToTime={handleSeekToTime}\n            stepBoundaries={narrationBoundaries}\n            stepDetails={narrationStepDetails}\n          />\n        )}\n      </div>\n    );\n  }\n);\n"]}